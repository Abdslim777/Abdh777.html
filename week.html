<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ v11</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        :root {
            --bg: #0a0c10;
            --card: #1c1f26;
            --primary: #238636;
            --accent: #58a6ff;
            --gold: #f0883e;
            --text: #c9d1d9;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            margin: 0;
            padding: 10px;
            display: flex;
            justify-content: center;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 15px;
        }

        /* Stats Section */
        .panel {
            background: var(--card);
            border-radius: 12px;
            border: 1px solid #30363d;
            padding: 20px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.5);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: #0d1117;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-top: 3px solid var(--accent);
        }

        .stat-card strong {
            display: block;
            font-size: 1.4rem;
            color: white;
            margin-top: 5px;
        }

        /* Live Activity Indicator */
        .status-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .pulse {
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            box-shadow: 0 0 0 rgba(35, 134, 54, 0.4);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(35, 134, 54, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(35, 134, 54, 0); }
            100% { box-shadow: 0 0 0 0 rgba(35, 134, 54, 0); }
        }

        /* Chat & Logs */
        .chat-section {
            background: #0d1117;
            border-radius: 8px;
            border: 1px solid #30363d;
            overflow: hidden;
            margin-top: 15px;
        }

        .chat-msgs {
            height: 250px;
            overflow-y: auto;
            padding: 15px;
            font-size: 0.9rem;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .msg { background: #1c1f26; padding: 8px 12px; border-radius: 6px; border-left: 3px solid var(--accent); }
        .msg.system { border-left-color: var(--gold); background: rgba(240, 136, 62, 0.1); }

        .chat-input-box {
            display: flex;
            padding: 10px;
            background: #161b22;
            gap: 8px;
        }

        input {
            flex: 1;
            background: #0d1117;
            border: 1px solid #30363d;
            color: white;
            padding: 10px;
            border-radius: 6px;
        }

        /* Treasures Side */
        .treasure-panel {
            background: var(--card);
            border-radius: 12px;
            border: 1px solid var(--gold);
            padding: 15px;
            height: calc(100vh - 40px);
            position: sticky;
            top: 10px;
            display: flex;
            flex-direction: column;
        }

        #foundList {
            flex: 1;
            overflow-y: auto;
            margin-top: 10px;
        }

        .wallet-card {
            background: #0d1117;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-right: 4px solid var(--gold);
            font-family: monospace;
            font-size: 0.85rem;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        @media (max-width: 900px) {
            .container { grid-template-columns: 1fr; }
            .treasure-panel { position: static; height: 500px; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="main-content">
        <div class="panel">
            <div class="status-header">
                <div class="pulse" id="statusDot"></div>
                <h2 style="margin:0; font-size: 1.2rem;">Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ v11</h2>
                <span id="scanStatus" style="font-size: 0.8rem; color: #8b949e; margin-right: auto;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
            </div>

            <div class="stats-grid">
                <div class="stat-card"><small>Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</small><strong id="idx">0</strong></div>
                <div class="stat-card"><small>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù„Ù</small><strong id="total">0</strong></div>
                <div class="stat-card" style="border-top-color: var(--gold);"><small>Ø§Ù„ÙƒÙ†ÙˆØ²</small><strong id="foundCount">0</strong></div>
            </div>

            <div style="background: #000; padding: 10px; border-radius: 8px; font-family: monospace; font-size: 11px; color: #7d8590; height: 80px; overflow-y: auto;" id="log">
                > Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ© Ù…ØªØµÙ„...
            </div>

            <div class="chat-section">
                <div style="padding: 10px; background: #161b22; font-size: 0.8rem; font-weight: bold; border-bottom: 1px solid #30363d;">ğŸ’¬ ØºØ±ÙØ© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¬ØªÙ…Ø¹</div>
                <div class="chat-msgs" id="chatMsgs"></div>
                <div class="chat-input-box">
                    <input type="text" id="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." onkeypress="if(event.key==='Enter') sendChat()">
                    <button class="btn" onclick="sendChat()">Ø¥Ø±Ø³Ø§Ù„</button>
                </div>
            </div>
        </div>
    </div>

    <div class="treasure-panel">
        <h3 style="margin-top:0; color:var(--gold); display: flex; align-items: center; gap: 8px;">
            <span>ğŸ’</span> Ø§Ù„ÙƒÙ†ÙˆØ² Ø§Ù„Ù…ÙƒØªØ´ÙØ©
        </h3>
        <div id="foundList"></div>
    </div>
</div>

<script>
    const config = { databaseURL: "https://blockchain-community-sync-default-rtdb.firebaseio.com/" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let scanning = false;
    let addrList = [];
    let curIdx = 0;
    const myName = "Explorer-" + Math.floor(Math.random() * 999);
    const RPCs = ['https://eth.llamarpc.com', 'https://bsc-dataseed.binance.org', 'https://polygon-rpc.com'];

    // Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©
    db.ref('global_index').on('value', s => { 
        curIdx = s.val() || 0; 
        document.getElementById('idx').innerText = curIdx.toLocaleString();
        // Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ù…Ø¬Ø±Ø¯ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¤Ø´Ø± ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
        if(!scanning && addrList.length > 0) startScanning();
    });

    db.ref('found_wallets').limitToLast(15).on('child_added', s => renderWallet(s.val()));
    db.ref('chat').limitToLast(20).on('child_added', s => renderChat(s.val()));

    async function load() {
        try {
            const r = await fetch('32.txt');
            if(!r.ok) throw new Error();
            const t = await r.text();
            addrList = t.split(/\s+/).filter(a => ethers.utils.isAddress(a));
            document.getElementById('total').innerText = addrList.length.toLocaleString();
            document.getElementById('scanStatus').innerText = "ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†. Ø¬Ø§Ø±ÙŠ Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ...";
            if(curIdx > 0) startScanning();
        } catch(e) { 
            document.getElementById('log').innerHTML += `<div style="color:#f85149">> Ø®Ø·Ø£: Ù…Ù„Ù 32.txt ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯.</div>`;
        }
    }

    function startScanning() {
        scanning = true;
        document.getElementById('scanStatus').innerText = "Ù†Ø¸Ø§Ù… Ø§Ù„ÙØ­Øµ ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ğŸš€";
        document.getElementById('statusDot').style.background = "var(--primary)";
        run();
    }

    async function run() {
        const BATCH = 30;
        while(scanning && curIdx < addrList.length) {
            const chunk = addrList.slice(curIdx, curIdx + BATCH);
            await Promise.all(chunk.map(async (a) => {
                const b = await check(a);
                if(b) {
                    const data = { a, b, u: myName, t: new Date().toLocaleTimeString() };
                    db.ref('found_wallets').push(data);
                    // ØªÙ†Ø¨ÙŠÙ‡ Ø¢Ù„ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
                    db.ref('chat').push({ u: "ğŸ“¡ Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø§Ø¯Ø§Ø±", m: `ØªÙ… Ø§ÙƒØªØ´Ø§Ù ÙƒÙ†Ø² Ø¬Ø¯ÙŠØ¯ Ø¨ÙˆØ§Ø³Ø·Ø© ${myName}!`, type: 'system' });
                }
            }));
            curIdx += BATCH;
            db.ref('global_index').set(curIdx);
            await new Promise(r => setTimeout(r, 100));
        }
    }

    async function check(a) {
        try {
            const p = new ethers.providers.JsonRpcProvider(RPCs[Math.floor(Math.random()*RPCs.length)]);
            const b = await p.getBalance(a);
            return b.gt(0) ? parseFloat(ethers.utils.formatEther(b)).toFixed(5) : null;
        } catch { return null; }
    }

    function sendChat() {
        const i = document.getElementById('chatInput');
        if(!i.value.trim()) return;
        db.ref('chat').push({ u: myName, m: i.value });
        i.value = "";
    }

    function renderChat(c) {
        const d = document.createElement('div');
        d.className = `msg ${c.type === 'system' ? 'system' : ''}`;
        d.innerHTML = `<b style="font-size:11px; color:var(--accent)">${c.u}</b><br>${c.m}`;
        const container = document.getElementById('chatMsgs');
        container.appendChild(d);
        container.scrollTop = container.scrollHeight;
    }

    function renderWallet(w) {
        const d = document.createElement('div');
        d.className = 'wallet-card';
        d.innerHTML = `<span style="color:var(--gold)">ğŸ’° ${w.b} ETH/BNB</span><br><small style="color:#8b949e; word-break:break-all">${w.a}</small>`;
        document.getElementById('foundList').prepend(d);
        document.getElementById('foundCount').innerText = document.getElementById('foundList').childElementCount;
    }

    window.onload = load;
</script>
</body>
</html>
