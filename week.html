<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø§Ø¯Ø§Ø± v14</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        :root { --bg: #080a0f; --card: #151921; --primary: #00d26a; --gold: #ffb100; --blue: #0095ff; }
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { margin: 0; background: var(--bg); color: white; overflow: hidden; height: 100vh; }
        
        /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨Ø§Ù„Ø³Ø­Ø¨ */
        .app-wrapper { height: 100vh; overflow-y: auto; scroll-snap-type: y mandatory; }
        section { height: 100vh; width: 100%; scroll-snap-align: start; padding: 20px; display: flex; flex-direction: column; }

        /* Ø§Ù„Ø´Ø§Ø´Ø© 1: Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .status-pill { background: rgba(0, 210, 106, 0.1); color: var(--primary); padding: 5px 15px; border-radius: 20px; font-size: 12px; display: inline-block; margin-bottom: 10px; }
        .main-stat { background: var(--card); border-radius: 30px; padding: 40px 20px; text-align: center; border: 1px solid #2d333b; flex: 1; display: flex; flex-direction: column; justify-content: center; position: relative; }
        .counter { font-size: 3rem; font-weight: 900; color: white; text-shadow: 0 0 15px var(--blue); }
        
        /* Ø§Ù„Ø´Ø§Ø´Ø© 2: Ø§Ù„ÙƒÙ†ÙˆØ² */
        .treasure-container { flex: 1; overflow-y: auto; background: #0d1117; border-radius: 15px; padding: 10px; border: 1px solid var(--gold); }
        .wallet-card { background: #1c2128; padding: 15px; border-radius: 12px; margin-bottom: 10px; border-right: 5px solid var(--gold); }

        /* Ø§Ù„Ø´Ø§Ø´Ø© 3: Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        .chat-wrap { flex: 1; background: #000; border-radius: 20px; display: flex; flex-direction: column; overflow: hidden; }
        #chatBox { flex: 1; overflow-y: auto; padding: 15px; font-size: 14px; }
        .msg { margin-bottom: 12px; border-radius: 8px; padding: 8px; background: #161b22; }
        .chat-form { display: flex; gap: 8px; padding: 10px; background: #1c2128; }
        
        input { flex: 1; background: #0d1117; border: 1px solid #30363d; color: white; padding: 12px; border-radius: 8px; outline: none; }
        .btn-send { background: var(--blue); border: none; color: white; padding: 0 20px; border-radius: 8px; font-weight: bold; }

        .nav-hint { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 12px; color: #555; pointer-events: none; }
    </style>
</head>
<body>

<div class="app-wrapper">
    <section id="screen1">
        <div class="main-stat">
            <div id="connectionStatus" class="status-pill">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©...</div>
            <h2 style="margin:0; font-size: 1rem; color: #8b949e;">Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù„Ù„ÙØ­Øµ</h2>
            <div class="counter" id="globalIdx">0</div>
            <div style="display:flex; justify-content: space-around; margin-top: 30px;">
                <div><small style="color:#555">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</small><br><b id="totalCount">0</b></div>
                <div style="color:var(--gold)"><small style="color:#555">Ø§Ù„Ù…ÙƒØªØ´ÙØ§Øª</small><br><b id="foundCount">0</b></div>
            </div>
            <div style="margin-top: 30px; font-size: 12px; color: var(--primary);" id="autoInfo">Ø§Ù„ÙØ­Øµ ÙŠØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø§Ù„Ø¢Ù† âš¡</div>
        </div>
    </section>

    <section id="screen2">
        <h2 style="color:var(--gold); margin-bottom:10px;">ğŸ’ Ø§Ù„ÙƒÙ†ÙˆØ² Ø§Ù„Ù…ÙƒØªØ´ÙØ©</h2>
        <div class="treasure-container" id="treasureList">
            <p style="text-align:center; color:#555; margin-top:20px;">Ù„Ù… ÙŠØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø±ØµÙŠØ¯ Ø¨Ø¹Ø¯...</p>
        </div>
    </section>

    <section id="screen3">
        <h2 style="color:var(--blue); margin-bottom:10px;">ğŸ’¬ Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ù…Ø¬ØªÙ…Ø¹</h2>
        <div class="chat-wrap">
            <div id="chatBox"></div>
            <div class="chat-form">
                <input type="text" id="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...">
                <button class="btn-send" onclick="sendChat()">Ø¥Ø±Ø³Ø§Ù„</button>
            </div>
        </div>
    </section>
</div>

<div class="nav-hint">Ø³Ø­Ø¨ Ù„Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„ØªÙ†Ù‚Ù„ â†•ï¸</div>

<script>
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ø±Ø©
    const firebaseConfig = { databaseURL: "https://radar-v14-final-default-rtdb.firebaseio.com/" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let addresses = [];
    let currentIdx = 0;
    const userName = "User-" + Math.floor(Math.random() * 999);
    const RPCs = ['https://eth.llamarpc.com', 'https://bsc-dataseed.binance.org', 'https://rpc.ankr.com/eth'];

    // Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ù…Ø¤Ø´Ø± ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    db.ref('global_idx').on('value', s => {
        currentIdx = s.val() || 0;
        document.getElementById('globalIdx').innerText = currentIdx.toLocaleString();
        if(addresses.length > 0) processBatch();
    });

    // Ø¬Ù„Ø¨ Ø§Ù„ÙƒÙ†ÙˆØ² (Ù…Ø²Ø§Ù…Ù†Ø© ØªØ§Ø±ÙŠØ®ÙŠØ© ÙˆÙ„Ø­Ø¸ÙŠØ©)
    db.ref('found').on('value', s => {
        const list = document.getElementById('treasureList');
        list.innerHTML = "";
        const data = s.val();
        if(data) {
            Object.values(data).reverse().forEach(w => {
                const div = document.createElement('div');
                div.className = 'wallet-card';
                div.innerHTML = `<b style="color:var(--gold)">ğŸ’° ${w.bal} ETH/BNB</b><br><small style="color:#8b949e; word-break:break-all;">${w.addr}</small><br><small style="color:var(--blue)">Ø¨ÙˆØ§Ø³Ø·Ø©: ${w.by}</small>`;
                list.appendChild(div);
            });
            document.getElementById('foundCount').innerText = Object.keys(data).length;
        }
    });

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
    db.ref('chat').on('child_added', s => {
        const c = s.val();
        const div = document.createElement('div');
        div.className = 'msg';
        div.innerHTML = `<b style="color:var(--blue)">${c.u}:</b> ${c.m}`;
        const box = document.getElementById('chatBox');
        box.appendChild(div);
        box.scrollTop = box.scrollHeight;
    });

    async function init() {
        try {
            const r = await fetch('32.txt');
            const t = await r.text();
            addresses = t.split(/\s+/).filter(a => ethers.utils.isAddress(a.trim()));
            document.getElementById('totalCount').innerText = (addresses.length - currentIdx).toLocaleString();
            document.getElementById('connectionStatus').innerText = "Ù…ØªØµÙ„ âœ…";
            processBatch();
        } catch(e) {
            document.getElementById('connectionStatus').innerText = "âŒ Ù…Ù„Ù 32.txt Ù…ÙÙ‚ÙˆØ¯!";
            document.getElementById('connectionStatus').style.color = "red";
        }
    }

    async function processBatch() {
        const SIZE = 20;
        if(currentIdx < addresses.length) {
            const batch = addresses.slice(currentIdx, currentIdx + SIZE);
            await Promise.all(batch.map(async (addr) => {
                const bal = await checkBal(addr.trim());
                if(bal) db.ref('found').push({ addr, bal, by: userName });
            }));
            currentIdx += SIZE;
            db.ref('global_idx').set(currentIdx);
            document.getElementById('totalCount').innerText = (addresses.length - currentIdx).toLocaleString();
        }
        setTimeout(processBatch, 2000);
    }

    async function checkBal(addr) {
        try {
            const p = new ethers.providers.JsonRpcProvider(RPCs[Math.floor(Math.random()*RPCs.length)]);
            const b = await p.getBalance(addr);
            return b.gt(0) ? ethers.utils.formatEther(b).substring(0,6) : null;
        } catch { return null; }
    }

    function sendChat() {
        const inp = document.getElementById('chatInput');
        if(inp.value.trim()) {
            db.ref('chat').push({ u: userName, m: inp.value });
            inp.value = "";
        }
    }

    window.onload = init;
</script>
</body>
</html>
